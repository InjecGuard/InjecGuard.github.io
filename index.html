<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="The first fully open-sourced safeguard model against prompt injection attacks with state-of-the-art performance and non-over-defense characteristics.">
  <meta property="og:title" content="InjecGuard: Benchmarking and Mitigating Over-defense in Prompt Injection Guardrail Models"/>
  <meta property="og:description" content="The first fully open-sourced safeguard model against prompt injection attacks with state-of-the-art performance and non-over-defense characteristics."/>
  <meta property="og:url" content="https://injecguard.github.io/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/images/figure_performance.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="InjecGuard: Benchmarking and Mitigating Over-defense in Prompt Injection Guardrail Models">
  <meta name="twitter:description" content="The first fully open-sourced safeguard model against prompt injection attacks with state-of-the-art performance and non-over-defense characteristics.">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/figure_performance.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="prompt injection defense, safeguard, over-defense">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Online Demo</title>

  <!-- Bulma framework -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/demo.css">


  <title>InjecGuard: Benchmarking and Mitigating Over-defense in Prompt Injection Guardrail Models</title>
  <link rel="icon" type="image/x-icon" href="static/images/guard.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">InjecGuard: Benchmarking and Mitigating Over-defense in Prompt Injection Guardrail Models</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://leolee99.github.io/" target="_blank">Hao Li</a><sup>1,2</sup><sup>*</sup>,</span>
                <span class="author-block">
                  <a href="https://sheltonliu-n.github.io/" target="_blank">Xiaogeng Liu</a><sup>3</sup><sup>*</sup></span>
                  <!-- <span class="author-block">
                    <a href="https://xiaocw11.github.io/" target="_blank">Chaowei Xiao</a>
                  </span> -->
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>University of Electronic Science and Technology of China</span><br>
                    <span class="author-block"><sup>2</sup>National University of Singapore</span><br>
                    <span class="author-block"><sup>3</sup>University of Wisconsin-Madison</span>
                    <span class="eql-cntrb"><small><br><sup>*</sup>Equal Contribution</small></span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/2410.22770" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>


                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/SaFoLab-WISC/InjecGuard" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://huggingface.co/datasets/leolee99/NotInject" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-database"></i>
                  </span>
                  <span>Dataset</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Prompt injection attacks pose a critical threat to large language models (LLMs), enabling goal hijacking and data leakage. Prompt guard models, though effective in defense, suffer from over-defense—falsely flagging benign inputs as malicious due to trigger word bias. To address this issue, we introduce NotInject, an evaluation dataset that systematically measures over-defense across various prompt guard models. NotInject contains 339 benign samples enriched with trigger words common in prompt injection attacks, enabling fine-grained evaluation. Our results show that state-of-the-art models suffer from over-defense issues, with accuracy dropping close to random guessing levels (60%). To mitigate this, we propose InjecGuard, a novel prompt guard model that incorporates a new training strategy, Mitigating Over-defense for Free (MOF), which significantly reduces the bias on trigger words. InjecGuard demonstrates state-of-the-art performance on diverse benchmarks including NotInject, surpassing the existing best model by 30.8%, offering a robust and open-source solution for detecting prompt injection attacks.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

  <section class="section">
    <div class="container is-max-desktop">
      <img class="columns is-centered has-text-centered" src="./static/images/figure_performance.png" alt="Teaser" width="80%"
      style="margin:0 auto">
      <!-- <img class="columns is-centered has-text-centered" src="./static/images/performance.png" alt="Teaser" style="width: 50%; clip-path: inset(5% 5% 5% 5%); margin: 0; padding: 0;"> -->
      <br>
      <figcaption>
          <p style="text-align: center; color: #000000;">
              <b>Figure 1:</b> Performance and efficiency comparison of existing prompt guardrail models.
          </p>
      </figcaption>
    </div>
  </section>

  <!-- Main container -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <h2 class="title is-2">Demos of InjecGuard</h2>
        <br>
      </div>
      <!-- <img class="columns is-centered has-text-centered" src="./static/images/figure_performance.png" alt="Teaser" width="80%"
      style="margin:0 auto">
      <br>
      <figcaption>
          <p style="text-align: center; color: #000000;">
              <b>Figure 1:</b> Performance and efficiency comparison of existing prompt guardrail models.
          </p>
      </figcaption> -->
      <div class="hero-body">
        <center>
          <video poster="" id="tree" autoplay controls muted loop width="82%" height="82%">
            <!-- Your video here -->
            <source src="static/videos/Demo.mp4" type="video/mp4">
          </video>
        </center>
        <h2 class="subtitle has-text-centered">
          A Demo of InjecGuard. 
        </h2>
      </div>
      <div class="container">
        <div class="form-container">
          <h2 class="title is-4"><span>&#9889;</span> Online Inference (InjecGuard)</h2> <!-- Reduced title size -->

          <!-- Input form -->
          <form id="inferenceForm">
            <textarea id="inputText" class="input-text" placeholder="Your sentence here..."></textarea>
            <button type="submit" class="compute-button" id="computeBtn">Submit</button>
          </form>

          <!-- Output display -->
          <div id="result">
            <h3 class="title is-5">Result:</h3> <!-- Reduced heading size -->

            <div class="progress-container" id="benignContainer">
              <div class="progress-label">Benign</div>
              <progress class="progress is-info" id="benignProgress" value="0" max="1"></progress>
              <div class="progress-score" id="benignScore">0.000</div>
            </div>

            <div class="progress-container" id="injectionContainer">
              <div class="progress-label">Injection</div>
              <progress class="progress is-danger" id="injectionProgress" value="0" max="1"></progress>
              <div class="progress-score" id="injectionScore">0.000</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    // Handle form submission
    document.getElementById("inferenceForm").addEventListener("submit", async function(event) {
        event.preventDefault();  // Prevent page reload

        const sentence = document.getElementById("inputText").value;
        const computeButton = document.getElementById("computeBtn");

        if (sentence === "") {
            alert("Please enter a sentence.");
            return;
        }

        // Clear previous output and show loading
        document.getElementById("benignProgress").value = 0;
        document.getElementById("injectionProgress").value = 0;
        document.getElementById("benignScore").innerText = "0.000";
        document.getElementById("injectionScore").innerText = "0.000";
        document.getElementById("result").style.display = "none";
        computeButton.classList.add("loading"); // Add loading spinner

        try {
            // Send the request to your endpoint
            const response = await fetch("https://d43yv1p4zw5qasjv.us-east-1.aws.endpoints.huggingface.cloud", {
                method: "POST",  // Assuming the endpoint requires POST method
                headers: { 
                  "Accept" : "application/json",
                  "Content-Type": "application/json" 
                },
                body: JSON.stringify({
                    "inputs": sentence
                })
            });

            // Parse the response
            const data = await response.json();

            // Hide the loading spinner
            computeButton.classList.remove("loading");

            // Assume data is an array with "label" and "score"
            let benignScore = 0;
            let injectionScore = 0;
            data.forEach(item => {
                if (item.label === "benign") {
                    benignScore = item.score;
                } else if (item.label === "injection") {
                    injectionScore = item.score;
                }
            });

            // Update progress bars and score text
            document.getElementById("benignProgress").value = benignScore;
            document.getElementById("benignScore").innerText = benignScore.toFixed(3);
            document.getElementById("injectionProgress").value = injectionScore;
            document.getElementById("injectionScore").innerText = injectionScore.toFixed(3);

            // Display the result section
            document.getElementById("result").style.display = "block";

        } catch (error) {
            // Hide the loading spinner
            computeButton.classList.remove("loading");
            alert("An error occurred: " + error.message);
        }
    });
  </script>

<section class="section">
  <div class="container is-max-desktop">

      <div class="columns is-centered has-text-centered">
          <h2 class="title is-2">Overdefense Benchmark: NotInject</h2>
          <br>
      </div>

      <!-- Overdefense Issue -->
      <div class="columns is-centered">
        <div class="column is-full-width">
            <h4 class="title is-3">• Overdefense Issue</h4>

            <div class="content has-text-justified">
                <img class="columns is-centered has-text-centered" src="./static/images/huggingface.png" alt="Teaser" width="95%"
                     style="margin:0 auto">
                <br>
                <figcaption>
                    <p style="text-align: center; color: #000000;">
                        <b>Figure 2:</b> Left: PromptGuard, Right: ProtectAIv2, both misclassify benign inputs as malicious due to an overreliance on specific trigger words, such as ``ignore''.
                    </p>
                </figcaption>
            </div>
            <br/>
        </div>
      </div>

      <!-- Pipeline -->
      <div class="columns is-centered">
          <div class="column is-full-width">
              <h4 class="title is-3">• Dataset Construction </h4>

              <div class="content has-text-justified">
                  <img class="columns is-centered has-text-centered" src="./static/images/pipeline.png" alt="Teaser" width="95%"
                       style="margin:0 auto">
                  <br>
                  <figcaption>
                      <p style="text-align: center; color: #000000;">
                          <b>Figure 3:</b> The pipeline for constructing NotInject dataset.
                      </p>
                  </figcaption>
                  <br>
                  <p>
                    <ul>
                      <li>
                          <b>Trigger Words Indentification.</b> To identify potential trigger words, was first conduct a word frequency analysis across both benign and injection datasets. The words are then ranked according to their frequency within each dataset, sorted separately for benign and injection datasets. By calculating the differences in word rankings between the two datasets, we highlight words that are disproportionately frequent in the injection dataset but rare in the benign dataset. These words are flagged as potential trigger words, which can serve as indicators of injection attempts.
                      </li>
                      <li>
                          <b>Trigger Words Refinement.</b>
                          To refine the list of candidate trigger words, a multi-step process is implemented to filter out irrelevant or commonly used terms that are not indicative of prompt injection attempts. Initially, a large language model (LLM) is employed to automatically assess the relevance of each word, based on the prompt: "Do you think the word of {word} is especially frequent in malicious or prompt attack scenarios?" This step helps eliminate words that are not pertinent to injection attacks. Following the automated filtering, a manual verification process is conducted to ensure the final list contains only words that are strongly associated with prompt injection attempts, further enhancing the accuracy of the trigger word identification.
                      </li>
                      <li>
                          <b>Corpus Generation.</b>
                          As a result of the refinement process, we select 113 trigger words and utilize a large language model (LLM) to generate benign sentences incorporating these words. The dataset is structured into three subsets, each containing samples with 1, 2, and 3 trigger words per sentence. To ensure that all generated sentences are non-malicious, both LLM-based and manual refinement processes are applied. The final dataset, termed NotInject, consists of 339 samples in total, with 113 samples in each subset. The generated sentences span a wide range of topics, including common queries, technical inquiries, virtual content creation, and multilingual queries, thus ensuring diversity and comprehensiveness.
                      </li>
                  </ul>
                  </p>
                  <br>
              </div>
              <br/>

          </div>
      </div>


  </div>
</section>

<!-- End Benchmark -->


<section class="section">
  <div class="container is-max-desktop">

      <div class="columns is-centered has-text-centered">
          <h2 class="title is-2">Injection Guardrail: InjecGuard</h2>
          <br>
      </div>

      <!-- InjecGuard -->
      <div class="columns is-centered">
        <div class="column is-full-width">
            <h4 class="title is-3">• Brief Introduction</h4>

            <div class="content has-text-justified">
              <br>
              <p>
                <b>InjecGuard</b> is a lightweight model designed to defend against prompt injection attacks. It delivers strong performance across benign, malicious, and over-defense accuracy metrics, surpassing existing guard models such as PromptGuard, ProtectAIv2, and LakeraAI. Despite its compact size, with model parameters of only 184MB, InjecGuard achieves competitive performance comparable to advanced commercial large language models like GPT-4.
                <br>
                <b>Note:</b> All training details, including the code and datasets, are fully released and available.
              </p>
              <br>
            </div>
            <br/>
        </div>
      </div>

      <!-- Main Results -->
      <div class="columns is-centered">
        <div class="column is-full-width">
            <h4 class="title is-3">• Evaluation</h4>

            <div class="content has-text-justified">
              <br>
                <img class="columns is-centered has-text-centered" src="./static/images/Results.png" alt="Teaser" width="80%"
                     style="margin:0 auto">
                <br>
                <figcaption>
                    <p style="text-align: center; color: #000000;">
                        <b>Figure 4:</b> Performance and overhead comparison between InjecGuard and other baseline models. 
                    </p>
                </figcaption>
            </div>
            <br/>
        </div>
      </div>

      <!-- Visualiazation -->
      <div class="columns is-centered">
        <div class="column is-full-width">
            <h4 class="title is-3">• Visualization</h4>

            <div class="content has-text-justified">
                <img class="columns is-centered has-text-centered" src="./static/images/visualization_concat.png" alt="Teaser" width="80%"
                     style="margin:0 auto">
                <br>
                <figcaption>
                    <p style="text-align: center; color: #000000;">
                        <b>Figure 5:</b> Left: The visualization of different predictions. Right: The visualization of attention weight. Given an instruction of ``[CLS] Can I ignore this warning appeared in my code? [SEP]'', ProtectAIv2 assigns extremely high attention weights to the word ``ignore,'' leading to misclassification as Injection. In contrast, our method distributes attention across the entire sentence, successfully predicting it as benign.
                    </p>
                </figcaption>
            </div>
            <br/>
        </div>
      </div>

  </div>
</section>

<!--BibTex citation -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@articles{InjecGuard,
title={InjecGuard: Benchmarking and Mitigating Over-defense in Prompt Injection Guardrail Models},
author={Hao Li, Xiaogeng Liu, Chaowei Xiao},
journal = {arXiv preprint arXiv:2410.22770},
year={2024}
}
</code></pre>
  </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Template</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

</body>
</html>
